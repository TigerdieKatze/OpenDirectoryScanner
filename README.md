# Open Directory Scanner

[![Build Status](https://github.com/TigerdieKatze/OpenDirectoryScanner/actions/workflows/ci.yml/badge.svg)](https://github.com/TigerdieKatze/OpenDirectoryScanner/actions/workflows/ci.yml)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

A powerful Rust tool that scans web directories and generates comprehensive reports on the contained files, including NSFW content detection.

## Features

- 🔍 **Recursive Directory Scanning**: Scan entire directory structures with configurable depth
- 📊 **File Classification**: Automatically categorizes files by type (images, videos, audio, documents)
- 🔢 **Format Analysis**: Identifies specific file formats (JPEG, PNG, MP4, etc.)
- 📏 **Size Analysis**: Tracks total size, identifies largest files and directories
- 🚨 **NSFW Detection**: Uses the [nsfw](https://crates.io/crates/nsfw) crate for detecting not-safe-for-work images
- 📝 **Report Generation**: Creates detailed reports in both console output and markdown formats
- 🌐 **Automatic Model Download**: Downloads the NSFW detection model automatically if not present

## Installation

### From Source

```bash
# Clone the repository
git clone https://github.com/TigerdieKatze/OpenDirectoryScanner.git
cd OpenDirectoryScanner

# Build the project
cargo build --release

# The binary will be available at target/release/opendirectoryscanner
```

> **Note:**  
> The NSFW detection model (`resources/model.onnx`) will be downloaded automatically by the program on first run if it is not already present.  
> No manual download is required.

## Usage

```bash
# Basic usage
opendirectoryscanner http://example.com/files/

# Specify scan depth
opendirectoryscanner http://example.com/files/ -d 5

# Save report to file
opendirectoryscanner http://example.com/files/ -o report.md

# Set request timeout
opendirectoryscanner http://example.com/files/ -t 60

# Full options
opendirectoryscanner http://example.com/files/ -d 4 -o report.md -t 45
```

### Command Line Options

| Option | Description | Default |
|--------|-------------|---------|
| `url` | The URL of the directory to scan | (required) |
| `-d, --depth` | Maximum directory depth to scan | 3 |
| `-o, --output` | Output file path for the report | (none) |
| `-t, --timeout` | Request timeout in seconds | 30 |

## Sample Report

The generated report includes:

- General statistics (total files, directories, size)
- File type breakdown (images, videos, audio, documents)
- Format distribution (JPEG, PNG, MP4, etc.)
- Largest file details
- Largest directory details
- NSFW content summary

## How NSFW Detection Works

This tool uses the [nsfw](https://crates.io/crates/nsfw) crate, which leverages a machine learning model to detect potentially inappropriate content in images.  
**The model file is automatically downloaded to `resources/model.onnx` if not present.**

The model can classify images into categories such as:

- Drawings
- Hentai
- Neutral
- Porn
- Sexy

The scanner considers an image NSFW if its porn score is above 0.5, hentai above 0.6, or sexy above 0.8. These thresholds can be adjusted in the source code if needed.

## HTML Parsing Compatibility

The directory scanning functionality is designed to work with standard directory listings generated by web servers like Apache, Nginx, etc. The HTML parsing may need adjustments for specific server configurations. If you encounter issues with certain directory structures, please open an issue with an example of the HTML structure.

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add some amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## License

This project is licensed under the MIT License - see the LICENSE file for details.

## Acknowledgements

- [nsfw](https://crates.io/crates/nsfw) crate for NSFW detection
- [reqwest](https://crates.io/crates/reqwest) for HTTP requests
- [scraper](https://crates.io/crates/scraper) for HTML parsing
- [clap](https://crates.io/crates/clap) for command-line argument parsing